# Configuration as Code

## Introduction

A/BBY aims to have the best Developer Experience possible.
This is why A/BBY is fully configurable via Code. No need to click some buttons in a GUI.
You `abby.config.ts` (or `abby.config.js`) file is the **single source of truth** for your A/BBY project.

Your configuration should be written in a file called `abby.config.ts` (or `abby.config.js`) which should be located in the root of your project.
Every integration offers a `defineConfig` helper function which offers a typesafe way to define your configuration.

```ts
import { defineConfig } from "@tryabby/core";
// or import { defineConfig } from "@tryabby/<integration>";
```

The config needs to be the default export of the file so that the CLI can find it.

```ts
import { defineConfig } from "@tryabby/core";
// or import { defineConfig } from "@tryabby/<integration>";

export default defineConfig({
  // your config here
});
```

## Philosophy

This configuration has two purposes:

#### 1. Integrations

A/BBY has many integrations to other tools and frameworks. Those can import the config and use it to configure themselves.
For example the `@tryabby/nextjs` integration uses the config to configure the Next.js framework. Reading the config makes the integrations fully typesafe

#### 2. CLI

The [A/BBY CLI](/reference/cli) uses the config to know what to do. It reads from the config and can then be used to create tests or feature flags on the A/BBY platform without
any further configuration.

## Example

```ts
// abby.config.ts

import { defineConfig } from "@tryabby/core";
// or import { defineConfig } from "@tryabby/<integration>";

export default defineConfig({
  projectId: "my-project-id",
  currentEnvironment: "development",
  environments: ["development", "production"],
  tests: {
    SignupButton: {
      variants: ["A", "B"],
    },
  },
  flags: {
    AdvancedTestStats: "JSON",
    showFooter: "Boolean",
    maxUserCount: "Number",
  },
  settings: {
    flags: {
      defaultValues: {
        Boolean: false,
        JSON: {},
        Number: 0,
        String: "",
      },
      devOverrides: {
        AdvancedTestStats: {},
        showFooter: true,
        maxUserCount: 40,
      },
    },
  },
});
```

## Config Reference

The `defineCOnfig` function takes an object as a parameter. The object can contain the following properties:

| Name               | Type     | Required | Description                                             | details               |
| ------------------ | -------- | :------: | ------------------------------------------------------- | --------------------- |
| projectId          | `string` |    ✅    | The ID of your project in Abby                          | -                     |
| apiUrl             | `string` |          | The URL of the Abby API. Defaults to the hosted version | -                     |
| currentEnvironment | `string` |    ✅    | The current environment of your application             | [link](/environments) |
| tests              | `object` |          | An object containing your defined A/B Tests             | -                     |
| flags              | `object` |          | An object containing your defined Feature Flags         | -                     |
| settings           | `object` |          | An object with additional settings for A/BBY            | -                     |

#### tests

The tests property is an object containing your defined A/B Tests. You probably want to use the Copy Button in your dashboard to copy the tests object.
They keys of the object represent the names of your predefined A/B tests. The values are objects containing the following properties:

| Name     | Type            | Required | Description                                             |
| -------- | --------------- | :------: | ------------------------------------------------------- |
| variants | `Array<string>` |    ✅    | An array of strings containing the variants of the test |

##### Example

```ts
const abby = createAbby({
  // ... your config
  tests: {
    "test-abtest": {
      variants: ["control", "variant-a", "variant-b"],
    },
  },
});
```

#### flags

The flags property is an array containing your defined Feature Flags. You probably want to use the Copy Button in your dashboard to copy the flags array.

##### Example

```ts
const abby = createAbby({
  // ... your config
  flags: { "test-flag": "Boolean" },
});
```

#### settings

The settings property is an object containing additional settings for A/BBY. The following properties are available:

- `flags.defaultValues`: Allows you to set a general default value for each flag type. The keys of the object represent the types of the flags.
  The default value is the following:

  ```json
  {
    "Boolean": false,
    "String": "",
    "Number": 0,
    "JSON": {}
  }
  ```

- `flags.devOverrides`: An object containing the values of feature flags in development mode. The keys of the object represent the names of the flags.
  The values need to be of the type of the flag. This means if your flag is a `String` flag, this needs to be a `string`.
